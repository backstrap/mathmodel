<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Coords.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Coords.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {sin, cos, identity, matrixMul} from '@backstrap/math';

/**
 * Compose two matrices (with null arg equivalent to identity matrix)
 * @type {function(number[][]?, number[][]?): number[][]}
 * @private
 */
const compose = ((a, b) => a &amp;&amp; b ? matrixMul(a, b) : b || a);

/**
 * Class representing a 3D coordinate system.
 */
export class Coords {
    /**
     * The current transformation matrix.
     * @member {number[][]|null}
     */
    #matrix = null;

    /**
     * Nominal step-count for parametric curves and surfaces.
     * @member {number}
     */
    dv = 100;

    /**
     * @param {Coords} parent
     */
    constructor(parent = null) {
        this.#matrix = (parent ? parent : this).#matrix;
    }

    /**
     * @param {number} [x]
     * @param {number} [y]
     * @param {number} [z]
     * @returns {this}
     */
    translate(x = 0, y = 0, z = 0) {
        this.#matrix = compose(
            this.#matrix,
            [[1, 0, 0, x], [0, 1, 0, y], [0, 0, 1, z], [0, 0, 0, 1]]
        );
        return this;
    }

    /**
     * @param {number} [s]
     * @returns {this}
     */
    scale(s = 1) {
        this.#matrix = compose(
            this.#matrix,
            [[s, 0, 0, 0], [0, s, 0, 0], [0, 0, s, 0], [0, 0, 0, 1]]
        );
        return this;
    }

    /**
     * @param {number} [x]
     * @param {number} [y]
     * @param {number} [z]
     * @returns {this}
     */
    stretch(x = 1, y = 1, z = 1) {
        this.#matrix = compose(
            this.#matrix,
            [[x, 0, 0, 0], [0, y, 0, 0], [0, 0, z, 0], [0, 0, 0, 1]]
        );
        return this;
    }

    /**
     * @param {number} [angle]
     * @param {number} [axis] - axis index (0, 1, or 2)
     * @returns {this}
     */
    rotate(angle = 0, axis = 0) {
        const a = axis > 0 ? 0 : 1;
        const b = axis &lt; 2 ? 2 : 1;
        const r = identity(4);
        r[a][a] = r[b][b] = cos(angle);
        r[a][b] = -(r[b][a] = sin(angle));
        this.#matrix = compose(this.#matrix, r);
        return this;
    }

    /**
     * @returns {this}
     */
    resetTransform() {
        this.#matrix = null;
        return this;
    }

    /**
     * Get a new duplicate transformed Coords object.
     * @returns {this}
     */
    dupe() {
        return new this.constructor(this);
    }

    /**
     * Apply current coordinate transform to vector v.
     * @param {number[]} v
     * @returns {number[]}
     */
    transform(v) {
        return this.#matrix ? this.#matrix.slice(0, 3).map(
                r => r[0]*v[0] + r[1]*v[1] + r[2]*v[2] + r[3]
            ) : v;
    }

    /**
     * Apply current un-translated coordinate transform to vector v.
     * @param {number[]} v
     * @returns {number[]}
     */
    orient(v) {
        return this.#matrix ? this.#matrix.slice(0, 3).map(
                r => r[0]*v[0] + r[1]*v[1] + r[2]*v[2]
            ) : v;
    }
}
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Canvas.html">Canvas</a></li><li><a href="Coords.html">Coords</a></li><li><a href="Geometry.html">Geometry</a></li><li><a href="GeometryOptions.html">GeometryOptions</a></li><li><a href="GroupedShape.html">GroupedShape</a></li><li><a href="MathModel.html">MathModel</a></li><li><a href="Plot.html">Plot</a></li><li><a href="Shape.html">Shape</a></li><li><a href="Solid.html">Solid</a></li><li><a href="Surface.html">Surface</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.10</a>
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
